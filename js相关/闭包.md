### 什么是闭包

可以访问自由变量的函数称之为闭包。什么叫自由变量呢？自由变量指的是既不属于函数参数也不属于函数局部变量的变量。那么按照这个定义来说的 javascript 里面所有的函数都可以称之为闭包。这应该算广义的闭包的概念，我们一般说的闭包指的是实践中的闭包

### 实践中的闭包

可以访问父级函数变量的函数是我们通常说的闭包。

### 闭包的应用

如果我们希望封装对象或者函数，不希望暴露给外部则可以选用闭包

```js
var test = (function() {
  var a = []
  return function() {
    a.push(...arguments)
    console.log(a)
  }
})()
```

### 面试题

```js
var a = []
for (var i = 0; i < 5; i++) {
  a[i] = function() {
    console.log(i)
  }
}
a[0]() // 5
a[1]() // 5
a[2]() // 5
```

打印出来都是 5。结合之前的全局上下文很容易理解因为这三个函数引用的 i 都是全局对象中的 i 值，i 最后变成了 5 所以打印出来是 5.

```js
var a = []
for (var i = 0; i < 5; i++) {
  a[i] = (function(i) {
    return function() {
      console.log(i)
    }
  })(i)
}
a[0]() // 0
a[1]() // 1
a[2]() // 2
```

改良版本，增加了一个闭包，这样就输出正常了。原因也很容易理解，这时候这三个函数里引用的 i 都是父级匿名函数的变量对象，而父级函数虽然销毁了，它的变量对象还保存在这三个函数的作用域链当中，因为这个变量对象存储着运行时对应的值所以打印出来就如我们预期了
